オルガーニャ２(ツヴァイ)   【Ver2.1.1】   簡易ヘルプ
★☆★☆★☆★☆★☆★☆★☆★☆★☆★☆★☆★☆★☆★☆★☆★☆★☆★☆★☆★☆

　基本的な使い方はPixelさんが開発された「オルガーニャ１」と同じです。
　ウィンドウサイズを可変にしたり音符に色をつけたり
　Dram表記をDrum表記にしたり（笑）
　解放されていなかったドラムオブジェクトを解放したり（笑ぇnyaぃ）
　アレコレアレコレ「自分にとって欲しかった」機能を追加しました。

　追加したドラム音はまさにそれで、現在私が作っているゲームソフトで
　使用する予定の音です。

　本当は公開するつもりはなかったのですが、
　PixelさんとこのBBSでオルガーニャ改変を望む声がチラホラございましたので
　お世話になったこともあり、何かお役に立てればと公開した次第であります。

　・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・
　ここ数年、春と秋のそれぞれ１ヶ月間に製作意欲が沸いています。
～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～

《重要な変更点　及び　注意事項》
■保存形式(2.0.0～)
　２から新たに追加したドラム音を使用した際は、１では読み込めません。
　新しいドラム音を選択しない場合は１でも読み込めます。

『トラック表記』
　メロディトラック
　　　0～7　　⇒ 1～8
　ドラムトラック
　　　8～15　 ⇒ Q～I
　コピーなどのﾄﾗｯｸ番号入力時は、1,2,3,4,5,6,7,8,Q,W,E,R,T,Y,U,Iを
　入力してください。

■標準MIDI形式でエクスポート(2.1.0～)
　　機能を作るのが10年遅かった！気づいたら2010年代ももう中盤だ。
　　MIDIの"トラック"と"チャネル"の違いに往生するところだった。
　　オマケ機能なので、つくりが荒いところがあります。
　　
　　以下を仕様とした。
　　[共通]
　　・一応、規格はGMとする。とはいえ、GM System ONは制約をかけるだけなので
　　　挿入しない。
　　　GS(Roland), XG(YAMAHA)はGMの上位互換なので問題ないはず。
　　・MSGSでも動作するように余計なCCイベントは挿入しない。
　　・最初の小節はコントロールチェンジのため使用しない。
　　　よってシーケンサしだいではオルガーニャと小節番号が+1ずれる。
　　　冒頭の無音時間を短縮するため、第０小節は高速テンポとする。
　　・オルガーニャの各トラックをMIDIの各チャネルに割り当てる。

　　[MELODY]
　　・オルガーニャの音色番号をプログラムチェンジの値とする。
　　　（とはいえ出力時に選択できる）
　　・音色自体の変更(RPN)は使わない。
　　・周波数設定は引き継ぐ。
　　　(オルガーニャは基準1,000、MIDIは基準が16,384)
　　・Pan値は前のNOTEから変動があったときにのみ、CCイベントを挿入する。
　　・Volumeの値はベロシティ値に反映させる。
　　・音階を伴わないダミーNOTEは無視する（変換しない）
　　・pipi指定の場合、音長を2/3とする。

　　[DRUM]
　　・ドラムは、当然、チャネル10を使う。
　　　オルガーニャのQ～Iまでの計８トラックを１チャネルに集約する。
　　・ドラムに限ってはPanの値は無視する（変換しない）
　　・ドラム音色はそれらしいものに変換する。猫とか無理だが。
　　　タムとクラッシュシンバルに限り、音階によってノートナンバーに
　　　変化を付ける。

　　[DIALOG]
　　・出力時に繰り返し回数を入力する。
　　　入力値次第でバカみたいなサイズのMIDIファイルも出力できる。
　　　コンダクタートラックにタイトルと著作者を挿入する。
　　・プログラムチェンジの値はダイアログで選択させる。

　　出力後は適宜MIDIシーケンサで修正することを前提としています。


■VOL操作(2.1.0～)
　きれいな曲線を描いて音を減衰させる場合に使用します。
　フリーハンドできれいな曲線が描ける人には無用です。

　(1)が既存NOTEに対して、(2)がﾀﾞﾐｰNOTE自動追加と操作結果が若干違います。
　例えば、線形減衰の場合、

　(1)既存NOTEに対しての場合：
　　 実音符の長さは考慮しない。ﾀﾞﾐｰ含めた選択範囲すべてのNOTEを対象とする
　　《操作前》　　　　　　　　　　　　　　⇒《操作後》
　　 |①─────　　　　③──────    |①─────　　　　③──────
　　 |　　　　　　②───                  |　　　　　　②───
　VOL|＊　　　　　＊　　　＊                |＊
　　 |　　　　＊　　　　　　　　　　　　　  |　　　　＊
　　 |　　　　　　　　　　　　　　　　　　  |　　　　　　＊
　　 |　　　　　　　　　　　　　　　　　　  |　　　　　　　　　　＊
　　フェードイン・アウトに使用します。

　(2)NOTE自動追加の場合：
　　 実音符の長さを考慮する。選択範囲すべてにﾀﾞﾐｰを追加し、音符ごとに処理を行う
　　《操作前》　　　　　　　　　　　　　　⇒《操作後》
　　 |①─────　　　　③──────    |①─────　　　　③──────
　　 |　　　　　　②───                  |　　　　　　②───
　VOL|＊　　　　　＊　　　＊                |＊　　　　　＊　　　＊＊
　　 |　　　　＊　　　　　　　　　　　　　  |　＊＊　　　　＊　　　　＊
　　 |　　　　　　　　　　　　　　　　　　  |　　　＊　　　　＊　　　　＊＊
　　 |　　　　　　　　　　　　　　　　　　  |　　　　＊＊　　　＊　　　　　＊＊
　　この機能を追加したかった。
　　内部処理としては、いったん選択範囲すべてにﾀﾞﾐｰNOTEを追加し、
　　実音符ごとに(1)を呼び出します。


■縮小表示時、音符の頭を目立たせる(2.1.0～)
　○チェックをつけない：
　　　ルーペで表示領域を縮小した場合、NOTEの頭が小さくなります。
　○チェックをつけたら：
　　　ルーペで表示領域を縮小した場合、NOTEの頭が16ﾄﾞｯﾄまで大きくなります。


■Trackごとに音符のy座標を少しずらす(2.1.0～)
　違うTrackの音符が完全に重なったときに後ろの音符が見えるように
　Trackごとに１ﾄﾞｯﾄ程度ずらして表示します。


■キーボード鍵盤(2.0.7～)
　　　Ｓ　　Ｆ　Ｇ　　Ｊ　Ｋ　Ｌ　　：　］
　　Ｚ　ＸＣ　Ｖ　ＢＮ　Ｍ　，　．／　￥
　　ラ　シド　レ　ミﾌｧ　ソ　ラ　シド　レ
　　
　　[Tab]　 １オクターブ上昇
　　[Shift] １オクターブ下降


■ショートカットキー（メニューに書いてないもの）
　１～８　トラック選択（メロディ）
　Ｑ～Ｉ　トラック選択（ドラム）
　Shift＋１～８　トラックミュート（メロディ）
　Shift＋Ｑ～Ｉ　トラックミュート（ドラム）

　F5　再生／停止
　０（テンキー）　再生／停止
　Alt＋→　再生
　Alt＋←　巻き戻し（停止）
　HOME　巻き戻し（停止）
　↑↓←→　スクロール
　
　ホイール　垂直方向にスクロール
　押しっぱなしホイール　水平方向にスクロール
　Shift(Ctrl)＋ホイール　水平方向にスクロール
　Ｏ　右クリックと同等
　Ｐ　左クリックと同等

　マウス機種によってついているボタン１　トラック選択＋１
　マウス機種によってついているボタン２　トラック選択－１
　　　※IEで「前ページに戻る」「次に進む」に用いられるボタン
　　　※ほとんど自分向けの機能です。

　１（テンキー）左端から＋１トラック選択 [Ctrl同時押しで全トラック対象]
　２（テンキー）左端から＋２トラック選択 [Ctrl同時押しで全トラック対象]
　３（テンキー）左端から＋３トラック選択 [Ctrl同時押しで全トラック対象]
　４（テンキー）左端から＋４トラック選択 [Ctrl同時押しで全トラック対象]
　５（テンキー）左端から＋８トラック選択 [Ctrl同時押しで全トラック対象]
　６（テンキー）左端から＋16トラック選択 [Ctrl同時押しで全トラック対象]

　７（テンキー）左端から×１トラック複写
　８（テンキー）左端から×２トラック複写
　９（テンキー）左端から×３トラック複写
　＋（テンキー）左端から×４トラック複写

■マウス操作
　Tab + 左クリック＆ドラッグ で範囲選択
        (最下段にマウスカーソルをもっていかなくてよい）

　Tab + 右クリック で範囲選択解除
        (最下段にマウスカーソルをもっていかなくてよい）

　範囲選択時にアプリケーションキー押下で小節単位での選択
　範囲選択時にAltキー押下で拍単位での選択

■機能説明

　『ｎ倍に引き伸ばす』
　音符の間隔と長さを伸ばします。リピート位置等の調整は行いません。
　途中で３連符を使いたくなったときに用います。

　『1/n倍に縮める』
　上記と逆の操作です。ｎの倍数の位置にない音符は削除します。

　◆カレントトラック～ドラムトラックへの操作
　　範囲が選択されていれば、その範囲に含まれる音符のみを変更します。

　『独自のダイアログで開く』【注意!!】
　コモンダイアログは自身のウィンドウサイズを保存しない仕組みになっていて
　ひとつのフォルダに（作業用として）多数のファイルを作る私としては
　ウィンドウサイズが小さいままだとファイルを探すのが面倒になるので
　とにかくサイズを大きく保ちたいがためにつけた機能です。
　コモンダイアログへのメッセージを適当にフックして
　しかも初期化はメッセージの内容ではなく呼ばれた回数で判断しているので
　結構キワドイと思います。（環境に依存するかもしれない）
　
　『常にｶﾚﾝﾄﾄﾗｯｸがﾀｰｹﾞｯﾄ』
　これも特殊な機能です。
　トラック変更時、選択範囲がカレントトラックになるように自動変更されます。
　また、全トラック選択が次のように解釈されます。
　　・カレントトラックが１～８⇒メロディトラック全体のみが選択
　　・カレントトラックがＱ～Ｉ⇒ドラムトラック全体のみが選択
　ドラムラインとメロディラインを分けてコピペしたいときに使います。


■範囲選択オペレータ
　基準となる小節は【画面の左端】に位置する小節です。
　右クリックで範囲解除します。
　『グリッド単位で～』をチェックすると拍単位での選択になります。

　このオペレータは癖が強いと思います。
　　　※ほとんど自分向けの機能です。


□wav形式でエクスポート
　　やろうとしたが、頓挫した。根気が足りていない。
　　LPDIRECTSOUNDCAPTUREBUFFERを使うかどうか。
　　ないしはPRIMARYBUFFERの再生位置に対してイベント設定し、
　　定期的にNOTIFYイベントを発行させ、バッファをごそっとコピーするか。
　　いずれにしても面倒だなー。


□Pan, Volumeをクリックすると光る
　　ver2.1.0では光るだけ。特に意味がない。
　　Selectは「常にｶﾚﾝﾄﾄﾗｯｸがﾀｰｹﾞｯﾄ」の切替として機能する。


■更新履歴
　2.1.1  2014/10/19　最近使ったファイルの0番を選択した際の不具合を修正
　　　　 　　　　　　表示するメッセージにString Tableを使用（中途半端だが）
　　　　 　　　　　　その他軽微な修正
　2.1.0  2014/05/31　挿入・削除機能を追加
　　　　 　　　　　　標準MIDI形式でエクスポート機能を追加
　　　　 　　　　　　VOL操作機能を追加
　　　　 　　　　　　トラックの入れ替え機能を追加
　　　　 　　　　　　ルーペ機能を追加
　2.0.8b 2011/10/17　ドラム音色追加
　2.0.8a 2010/12/01　停止時に完全に音が鳴り止むように変更
　　　　 　　　　　　テンキーで小節選択・複写ボタンをシミュレート
　2.0.8  2010/09/28　Windows 7(x64)で快適に動かすため、微調整
　　　　 　　　　　　メニュー構成を一部変更
　　　　 　　　　　　2.0.1で追加したドラムの音量修正
　2.0.7  2010/08/14　ＣＰＵ負荷低減と編集時のイライラ低減のため描画周り見直し
　　　　 　　　　　　キーボード鍵盤ZXCVB...で演奏可能に
　　　　 　　　　　　垂直スクロールバーのレンジ幅見直し
　2.0.6  2008/05/13　バグ対応，メロディorドラムのみミュート機能追加
　2.0.5  2005/02/24　ダイアログウィンドウのデザイン変更, 常にｶﾚﾝﾄﾄﾗｯｸがﾀｰｹﾞｯﾄ
　　　　 　　　　　　最近使ったファイル・全トラック表示(ゴースト)
　　　　 　　　　　　アプリケーションにファイル名を渡すと自動ロード
　2.0.4  2005/02/13　音符の描画ルーチンを改変，パン初期値をトラック毎に
　2.0.3  2005/02/13　変拍子に対応
　2.0.2  2005/02/11　アンドゥ・リドゥを実装，範囲選択に関する操作を実装
　2.0.1  2005/02/07　↓の日付・スクロール関連の不具合(RECTの指示違い)
　2.0.0  2004/02/06

■配布元
　http://www5b.biglobe.ne.jp/~kiss-me/aji/index.html


■制限事項
　２画面（マルチモニタ）環境の場合、メインモニタのサイズを超す領域に五線譜が
　描画されません。
　一度ウィンドウを大きくしてから再起動することで２画面目にも描画されるように
　なります。
　…仮想ディスプレイのサイズを返す関数がVC++6.0でサポートされていないため、
　苦肉の策です。

　キーボード鍵盤は同時発音の制限があります。
　たまに音が鳴りっぱなしになります。

　ファイル名に使用可能な文字は、char型で扱える…ASCII(半角英数)とShift_JISに
　限定されます。Shift_JISに規定のある第三・第四水準漢字は使えますが、
　逆にUnicodeにしかない珍妙な文字・記号は使えません。
　charをwchar_t型に直して文字列操作関数・ファイル操作関数を適切に指定すれば
　扱えるようになるのでしょうね。









－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
　以下はオルガーニャ1.3.4に付属されていたヘルプファイルです。
　若干、仕様が異なる点もございますが、ご参考までに。
－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－

《オルガーニャ説明書》
－－－Version November 3 1999 (Ver1.0)－－－
は、音譜が増えると重くなる。
－－－Version November 10 1999 (Ver1.1)－－－
はコピー機能（連続）に問題。
－－－Version November 16 1999 (Ver1.2)－－－
は、再生中にミュートが解除できないなどバグ。
PiPiというのが無い。
－－－Version November 25 2000 (Ver1.3)－－－
トラック６のミュートバグ
------Version 1.3.1 2001/03/21 --------------
Delete終了後に「消去しました」のメッセージ。
------Version 1.3.1 2001/04/07 --------------
------Version 1.3.4 2003/03/23 --------------
ウエイトの最小値を1にした。


開発室Pixelの Amaya です。

開発室ではMIDI音源を使わない作曲ソフトとして、以前"PiyoPiyo"と言う
ものを作り使っておりました。初の一般公開ツールと言う事で、アップ後
も使用中にいくらか問題がでました。

それを踏まえた上で、August 1999 から現在にかけてついに次回作"オルガ
ーニャ"が完成しました。以前はいくらか力技で妥協していた"PiyoPiyo"の
システムをさらに表現力豊か(ショボイ音ですが)にしました。

基本的には開発室内で使うツールなので、あまり一般的とは言えませんが、
まれに｢なぜかショボイ音が好き｣と言う人がいて、更に｢その音で作曲したい｣
というのならこのツールはウッテツケです☆

｣｣｣"オルガーニャ"基本仕様｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣
＜本体容量＞－－－－－－－－－－－－－－－－－－－－－－
188Kbyte(192,512byte)
＜動作確認スペック＞－－－－－－－－－－－－－－－－－－
Windows95/DirectX5/CPU:166MHz/MMX/VRAM:2MByte/ﾒﾓﾘ:32MByte
＜最大同時発音数＞－－－－－－－－－－－－－－－－－－－
１トラックに１音で計１６音同時に出せます。

＜音色＞－－－－－－－－－－－－－－－－－－－－－－－－
０～７トラックは100種類の波形から選択します。(主にメロディ)
⑧～⑮トラックは10種類の波形から選択します。(主にパーカッション)

＜記録音譜数＞－－－－－－－－－－－－－－－－－－－－－
このバージョンでは１トラックに4096個で一曲計65536個の音譜を
記録する音ができます。現在使用量と残量をメニューの｢デバッグ｣
で確認する事ができます。

｣｣｣転載など｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣
このソフトはフリーソフトです。転載、コピーを許可します。
E-mailで連絡をいただければ幸いです。尚、このソフトによる
問題には一切の責任を負いません。制作に悪意が無い事をご理解
ください。

｣｣｣使い方｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣
＜音譜配置編＞－－－－－－－－－－－－－－－－－－－－－
●音譜を置く

　左クリックで音譜を置きます。
　更に音譜のある所でクリックすると、音譜が延びます。

●音譜を消す
　
　右クリックで音譜を消します。
　長い音譜の場合は音譜が縮みます。

●パンポットを変える

　パンポットラインを左クリックするとパンぽっとシンボルが置けます。

●ボリュームを変える

　ボリュームラインを左クリックするとボリュームシンボルが置けます。
　

●音を変える

　｢設定｣の中にある｢波形選択｣をクリック。
　０～７トラックの音は100音の中から選びます。
　⑧～⑮トラックの音は10音の中から選びます。

＜曲設定編＞－－－－－－－－－－－－－－－－－－－－－
メニューにある｢設定｣の中の｢曲設定｣で曲のパラメータ変更ができます。
決定は｢Ok!｣を、キャンセルの場合は｢No!｣をクリックしてください。

●テンポを変える

　｢曲設定｣のウエイトを変えます。
　数値が大きいほど曲の進行が遅くなります。

●リピート範囲を変える

　｢曲設定｣のリピート範囲を変えます。
　あたま８、おわり６５で、６４小節を演奏後に８小節に戻ります。

●拍子を変える

　表示グリッドを変えます。

●周波数を変える

　｢曲設定｣の周波数を変えます。
　これは０～７トラックのみ変更可能です。
　1000がノーマルで、100から1900までの値を入力します。

●PiPi
　グリッドよりも短い音を使用します。

＜範囲編集編＞－－－－－－－－－－－－－－－－－－－－
メニューにある｢範囲編集｣でコピーや削除、また、ボリュームなどの
範囲変更が可能です。

●コピー
　一つのトラックに対して、コピーペーストを行います。
　コピー元 Track 0：Meas 0：Beat 0：～ Meas 8：Beat 0 
　　　→トラック０の０小節から７小節のおわりまでを、
　コピー先 Track 3：Meas 4：Beat 0：
　　　→トラック３の４小節目に、
　回数 4
　　　→４回貼り付ける。

●セットコピー

　コピーの内容を同時に複数トラックに施します。
　対象トラックをチェックしてください。

●パンポット

　範囲指定でパンポットを動かします。
　｢値｣にどれだけか。｢加算／減算｣で"↑"なら右に"↓"なら左に動かします。

●ボリューム

　範囲指定でボリュームを動かします。
　｢値｣にどれだけか。｢加算／減算｣で"↑"なら加算に"↓"なら減算です。

●トランスポーズ

　範囲指定でキー(音程)を動かします。
　｢値｣にどれだけか。｢加算／減算｣で"↑"なら加算に"↓"なら減算です。

●消去

　範囲指定で音譜を消去します。
　指定方法はコピーを参照してください。



｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣
オルガーニャ By 開発室Pixel
URL → http://hp.vector.co.jp/authors/VA022293/
